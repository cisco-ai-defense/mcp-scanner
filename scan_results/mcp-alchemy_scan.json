2025-10-30 15:50:31,841 - mcpscanner.core.analyzers.base.Behavioural - INFO - BehaviouralAnalyzer initialized with LLM-based analysis
2025-10-30 15:50:31,841 - mcpscanner.core.analyzers.base.Behavioural - INFO - Scanning directory: /var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy
2025-10-30 15:50:31,843 - mcpscanner.core.analyzers.base.Behavioural - INFO - Found 3 Python file(s) to analyze
2025-10-30 15:50:31,850 - mcpscanner.core.analyzers.base.Behavioural - INFO - Built call graph with 14 functions
2025-10-30 15:50:31,850 - mcpscanner.core.analyzers.base.Behavioural - INFO - Analyzing file: /var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy/mcp_alchemy/__init__.py
2025-10-30 15:50:31,850 - mcpscanner.core.analyzers.base.Behavioural - INFO - Analyzing file: /var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy/mcp_alchemy/server.py
2025-10-30 15:50:31,896 - mcpscanner.core.analyzers.base.Behavioural - INFO - Found 4 MCP functions in /var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy/mcp_alchemy/server.py
2025-10-30 15:50:39,781 - mcpscanner.core.analyzers.base.Behavioural - INFO - Analyzing file: /var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy/tests/test.py
2025-10-30 15:50:39,784 - mcpscanner.core.analyzers.base.Behavioural - INFO - Behavioural analysis complete: 2 finding(s) detected
[
  {
    "tool_name": "schema_definitions",
    "tool_description": "MCP function from server.py",
    "status": "completed",
    "is_safe": false,
    "findings": {
      "behavioural_analyzer": {
        "severity": "MEDIUM",
        "threat_summary": "Line 125: Description claims: 'No docstring provided; the function does not disclose its purpose or side effects.' | Actual behavior: The function inspects database schema information for the provided table names by connecting to a database and retrieving columns, primary keys, and foreign key relationships using inspector methods.",
        "threat_names": [
          "DESCRIPTION_MISMATCH"
        ],
        "total_findings": 1,
        "source_file": "/var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy/mcp_alchemy/server.py",
        "mcp_taxonomy": null
      }
    }
  },
  {
    "tool_name": "execute_query",
    "tool_description": "MCP function from server.py",
    "status": "completed",
    "is_safe": false,
    "findings": {
      "behavioural_analyzer": {
        "severity": "HIGH",
        "threat_summary": "Line 170: Description claims: 'No docstring provided; the function does not disclose its behavior to the user.' | Actual behavior: Executes an arbitrary SQL query (from 'query' parameter) with user-supplied parameters against a database connection, then saves the full result set as a JSON file in a local directory and returns a URL pointing to this file hosted on a public CDN (jsdelivr.net).",
        "threat_names": [
          "DESCRIPTION_MISMATCH"
        ],
        "total_findings": 1,
        "source_file": "/var/folders/5b/tl5xxjnx1qng1bxm4kxfsjk00000gn/T/mcp_scan_hjoozfe1/mcp-alchemy/mcp_alchemy/server.py",
        "mcp_taxonomy": null
      }
    }
  }
]
